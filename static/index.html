<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problems Repository</title>
</head>
<style>
    .scrollable-table {
        overflow-y: auto;
        height: 600px;
    }

    .table {
        border-collapse: collapse;
        font-size: 20px;
        width: 100%;
    }

    .table th {
        text-align: left;
        background-color: #8f9898;
        position: sticky;
        top: 0;
    }

    .table th,
    .table td {
        padding: 6px 8px;
        font-weight: normal;
    }

    tr:hover {
        background-color: #e2ecec5b;
    }
</style>

<body>
    <h1>Solved DSA Problems</h1>
    <p>Add new solved problem</p>
    <form>
        <label>Problem : </label>
        <input type="text" name="Problem" id="prob" autocomplete="off" size="50px">
        <label>Platform : </label>
        <input type="text" name="Platform" autocomplete="off" id="plat">
        <label>Description : </label>
        <input type="text" name="Description" size="100px" autocomplete="off" id="desc">
        </br>
        </br>
        <label>Intiution : </label>
        <input type="text" name="Intiution" size="100px" autocomplete="off" id="intiu">
        <label>Link : </label>
        <input type="text" name="Link" size="30px" autocomplete="off" id="link">
        <br />
        <br />
        <input type="button" value="submit" onclick="insertProblem()"/>
        <br />
        <br />
        <label>DELETE PROBLEM : </label>
        <input type="number" name="DELETE ID" id="dId" autocomplete="off" size="10px" >
        <input type="button" value="DELETE" onclick="deleteProblem()"/>
    </form>
    </br>
    <p>Here is the list of solved problems</p>
    </br>
    <div class="scrollable-table">
        <table class="table">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Problem</th>
                    <th>Platform</th>
                    <th>Description</th>
                    <th>Intiution</th>
                    <th>Link</th>
                </tr>
            </thead>
            <tbody id="problems">

            </tbody>
        </table>
    </div>
    <script>
        function populateData() {
            fetch(`http://localhost:9090/problems`)
                .then(response => response.json())
                .then(data => {
                    var list = document.getElementById("problems")
                    data.forEach((problem) => {
                        var tdId = document.createElement("td")
                        tdId.innerText = problem.id
                        var tdProblem = document.createElement("td")
                        tdProblem.innerText = problem.problem
                        var tdPlatform = document.createElement("td")
                        tdPlatform.innerText = problem.platform
                        var tdDescription = document.createElement("td")
                        tdDescription.innerText = problem.desc
                        var tdIntiution = document.createElement("td")
                        tdIntiution.innerText = problem.intiution

                        var tdLink = document.createElement("td")
                        tdLink.innerHTML = `<a href=${problem.link} target="_blank">Link</a>`

                        var tr = document.createElement("tr")
                        tr.appendChild(tdId)
                        tr.appendChild(tdProblem)
                        tr.appendChild(tdPlatform)
                        tr.appendChild(tdDescription)
                        tr.appendChild(tdIntiution)
                        tr.appendChild(tdLink)

                        document.getElementById("problems")
                            .appendChild(tr)
                    });
                })
        }
        async function insertProblem() {
            let problem = {
                "problem": document.getElementById("prob").value,
                "platform": document.getElementById("plat").value,
                "desc": document.getElementById("desc").value,
                "intiution": document.getElementById("intiu").value,
                "link": document.getElementById("link").value,
            }
            await fetch("http://localhost:9090/problems/add",
            {
                method: "POST",
                mode: "no-cors",
                body: JSON.stringify(problem),
                headers: {
                    "Content-Type": "application/json",
                }
            })
            window.location.reload()
        }
        async function deleteProblem() {
            let id = document.getElementById("dId").value
            await fetch(`http://localhost:9090/problem?id=${id}`,
            {
                method: "DELETE",
            })
            window.location.reload()
        }
        populateData()

    </script>
</body>

</html>